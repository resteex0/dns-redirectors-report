first writting :6-12-2021,
attack group code name : dns-redirectors(dga),
type of group : robots process automation of attacks , remarks: very rare c2 commnication as domination in investigation, ip :104.18.3.114 , company name of dns server comprimsed : cloudflare

# this file will achieve as soon one million evil ip (unique organic ip evil brokers as biggest malware dropper root redirectors http or dns in history) related to new technique of hunting and open investigation report without external resource edr or samilar
the list will defend from darkevil of iceberge internet network worldwide 

please be save , you traditional of antivirus and firewall not save you from sniffing(sessions hijacking) at minumum threat now online 

hidden real black hackers are compromised totally almost all website , not have any company now and website not have compromise , if you ask me example is github or another same as big organization is compromised ? my answer in this sheet nslookup for ip inside sheet and see rabit hole

this new freshelly upload video on youtube from blackhat about vulnarability domain hijacking related to dns(spoofing master dns) by duplictad fqdn with differnt ip without validation registrtion dns record = almost this ip attackers in my list  related to this vulnarbility , now as 7-12-2021 , the world under distributed attacks now , poc in resourse below , if any one see this and not takecare about blackevil ip i think his already compromised and very late to response

before days the steps of this attack is bruteforce of ssh , poc of this logging faluir frequency , and suspoius traffic with start tcp flage A or AP and TLS Handshake Failure , if you good firwall but not harding your system you already compreised too by sending emails to attackers with hidden connections and traffic same as dns tunnel technique including critical info of your system and may be keyloggin as achieve goal of attacker

dga algo used by automation hackers from creating to last stage of attacks to build complex of network of dns server effected to replicated quariers to another nodes untile getting dropped malware by trying passing your original quary to multi maloius dns server , example for that if you request any website should not at normal excessed 1 dns quarie ( one ip resolved to domain) , but in our case any traffic excessed more than 100 dns quareis in on request , this normal ? offcourse not , this biggest network of malware brokers traget almost one

attacker bypass registrtion domains to aviod sniffing traffic by getting subdomain of famous domain samae as x.github.com 
to avoid any one registration this subdomain because child of registed parrent host domain (github.com)and have soc team itself back of attackers , after that attckers pointers the new subdomain with external dns or ip also famous company same as cloudflare  and change subdomain automaticall every time with fixed ip because ip in controle network of replications of query

unsecure recuresive dns query can be lead to very high potential infected by evilbrokers malicous dns server to start redirection to exploit kit or direct dropping long chains of malwarefamily to getting high chance for payload backdoor 

# [TCP Previous segment not captured] Continuation indication (the critical point of exploitation)

https://networkengineering.stackexchange.com/questions/55461/tcp-errors-explain

TCP Previous segment not captured

If packet N is marked with previous segment not captured, it means that in the capture there is no packet from the same TCP session whose seq + length would match the seq of packet N. The most typical reason is packet loss and/or late start of capture, which is the reason why the wording in question is used. But there can eventually be other reasons (buggy TCP stack of the sender, multipath network structure allowing packets belonging to the same TCP session to pass through different network interfaces so the packets do reach their destination but Wireshark cannot see them, ...), so it is up to you to check out the real reason why this has happened in your particular case.



# poc of passive dns and malware dropping file in investigation by this link :

 https://www.virustotal.com/graph/embed/g486e9a34a4ce493688877dab07166e6b92a8b3f80c824f7a9facda1284cb735d


',,,,,,,,,,,, this biggest distributed dns attack in histroty this days'

https://youtu.be/_e9BACYRyKU ,
https://youtu.be/ihxkxV80u6I

https://app.any.run/tasks/39c11bb7-edbe-40a6-9f58-458008cafc72
https://any.run/report/4fff4b3d317901d89f8fff180cde4b9600ded2a158ea019c5a705e235e562c69/39c11bb7-edbe-40a6-9f58-458008cafc72

https://www.hybrid-analysis.com/sample/18012fc476a1dd5d4b91975f52f7dd66684a23a392bb9ef81fc126f2cc94d745/61a2dd2906f6413f275845ea

https://www.hybrid-analysis.com/sample/18012fc476a1dd5d4b91975f52f7dd66684a23a392bb9ef81fc126f2cc94d745/61a2dd2906f6413f275845ea#sample-network-traffic

https://www.joesandbox.com/analysis/529750/0/html
https://www.joesandbox.com/analysis/499413/0/html

https://youtu.be/5XuPLBB0JIA

# sneak ack attack (tcp-split handshake attack) is major vulerability in network traffic without firewall rules 
https://www.secplicity.org/2011/04/15/what-is-the-tcp-split-handshake-attack-and-does-it-affect-me/
https://nmap.org/misc/split-handshake.pdf

# stage (I) : att&ck mitre matrix / (1) intial access / (a) drive by compromise 

# cross site scripting (xss) now playing big roles in attacks
found iframes	
Hide sources(xss stored by javascript injection and xss reflected in url encoded) very clear

Source: https://ethsysteminv.com/index-de.html?transaction_id=U0EyTys4TmJSWWs9	HTTP Parser: Iframe src: https://player.vimeo.com/video/609887658
Source: https://ethsysteminv.com/index-de.html?transaction_id=U0EyTys4TmJSWWs9	HTTP Parser: Iframe src: https://www.coingecko.com/en/widget_component/ticker/ethereum/gbp?id=ethereum
Source: https://ethsysteminv.com/index-de.html?transaction_id=U0EyTys4TmJSWWs9	HTTP Parser: Iframe src: https://player.vimeo.com/video/609887658
Source: https://ethsysteminv.com/index-de.html?transaction_id=U0EyTys4TmJSWWs9	HTTP Parser: Iframe src: https://www.coingecko.com/en/widget_component/ticker/ethereum/gbp?id=ethereum
Source: https://www.coingecko.com/en	HTTP Parser: Iframe src: https://tpc.googlesyndication.com/safeframe/1-0-38/html/container.html
Source: https://www.coingecko.com/en	HTTP Parser: Iframe src: https://tpc.googlesyndication.com/safeframe/1-0-38/html/container.html
Source: https://www.coingecko.com/en	HTTP Parser: Iframe src: https://1f5cfc4e0928611bed5eaa6a1a4de64e.safeframe.googlesyndication.com/safeframe/1-0-38/html/container.html
Source: https://www.coingecko.com/en	HTTP Parser: Iframe src: https://sync.richaudience.com/74889303289e27f327ad0c6de7be7264/?p=1BTOoaD22a&r=https%3A%2F%2Fmp.4dex.io%2Fsetuid%3Fbidder%3Drichaudience%26uid%3D[PDID]
Source: https://www.coingecko.com/en	HTTP Parser: Iframe src: https://aax-eu.amazon-adsystem.com/s/iu3?cm3ppd=1&d=dtb-pub&csif=t&dl=n-LoopMe_n-acuityads_ox-db5_dm_smrt_cnv_n-amobee_n-smaato_n-sharethrough_pm-db5_ym_rbd_an-db5_sovrn
Source: https://www.coingecko.com/en	HTTP Parser: Iframe src: https://secure-assets.rubiconproject.com/utils/xapi/multi-sync.html?p=onfocus&endpoint=eu
Source: https://www.coingecko.com/en	HTTP Parser: Iframe src: https://tpc.googlesyndication.com/sodar/sodar2/224/runner.html
Source: https://www.coingecko.com/en	HTTP Parser: Iframe src: https://www.google.com/recaptcha/api2/aframe
Source: https://www.coingecko.com/en	HTTP Parser: Iframe src: https://ads.pubmatic.com/AdServer/js/user_sync.html?p=159110&predirect=https%3A%2F%2Fmp.4dex.io%2Fsetuid%3Fbidder%3Dpubmatic%26uid%3D(PM_UID)
Source: https://www.coingecko.com/en	HTTP Parser: Iframe src: https://eu-u.openx.net/w/1.0/pd?plm=6&ph=626fe778-b2ca-415b-a3f6-584fd2ac5ec0&gdpr=0
Source: https://www.coingecko.com/en	HTTP Parser: Iframe src: https://eus.rubiconproject.com/usync.html
Source: https://www.coingecko.com/en	HTTP Parser: Iframe src: https://ap.lijit.com/beacon?informer=8128488
Source: https://www.coingecko.com/en	HTTP Parser: Iframe src: https://eb2.3lift.com/sync?
Source: https://www.coingecko.com/en	HTTP Parser: Iframe src: https://contextual.media.net/checksync.php?vsSync=1&cs=8&cv=31&https=1&cid=8CU18831I&prvid=2034%2C2033%2C2011%2C3022%2C3020%2C2030%2C273%2C251%2C175%2C2009%2C255%2C178%2C3018%2C2028%2C3017%2C2027%2C236%2C214%2C237%2C2025%2C3014%2C117%2C70%2C97%2C99%2C77%2C38%2C3012%2C3011%2C3010%2C182%2C261%2C141%2C222%2C3007%2C201%2C4%2C301%2C246%2C225%2C203%2C80%2C10000%2C9%2C108&purpose1=1&gdprconsent=1&gdpr=0&usp_status=0&usp_consent=1&itype=PREBID
Source: https://www.coingecko.com/en	HTTP Parser: Iframe src: https://acdn.adnxs.com/dmp/async_usersync.html
Source: https://www.coingecko.com/en	HTTP Parser: Iframe src: https://onetag-sys.com/usync/?cb=1633716940998
Source: https://www.coingecko.com/en/coins/ethereum/gbp?ref=wticker	HTTP Parser: Iframe src: https://tpc.googlesyndication.com/safeframe/1-0-38/html/container.html
Source: https://www.coingecko.com/en/coins/ethereum/gbp?ref=wticker	HTTP Parser: Iframe src: https://9703e087e418f934863e5cce8881878a.safeframe.googlesyndication.com/safeframe/1-0-38/html/container.html
Source: https://www.coingecko.com/en/coins/ethereum/gbp?ref=wticker	HTTP Parser: Iframe src: https://aax-eu.amazon-adsystem.com/s/iu3?cm3ppd=1&d=dtb-pub&csif=t&dl=n-LoopMe_n-acuityads_ox-db5_dm_smrt_cnv_n-amobee_n-smaato_n-sharethrough_pm-db5_ym_rbd_an-db5_sovrn
Source: https://www.coingecko.com/en/coins/ethereum/gbp?ref=wticker	HTTP Parser: Iframe src: https://tpc.googlesyndication.com/safeframe/1-0-38/html/container.html
Source: https://www.coingecko.com/en/coins/ethereum/gbp?ref=wticker	HTTP Parser: Iframe src: https://tpc.googlesyndication.com/safeframe/1-0-38/html/container.html
Source: https://www.coingecko.com/en/coins/ethereum/gbp?ref=wticker	HTTP Parser: Iframe src: https://9703e087e418f934863e5cce8881878a.safeframe.googlesyndication.com/safeframe/1-0-38/html/container.html
Source: https://www.coingecko.com/en/coins/ethereum/gbp?ref=wticker	HTTP Parser: Iframe src: https://aax-eu.amazon-adsystem.com/s/iu3?cm3ppd=1&d=dtb-pub&csif=t&dl=n-LoopMe_n-acuityads_ox-db5_dm_smrt_cnv_n-amobee_n-smaato_n-sharethrough_pm-db5_ym_rbd_an-db5_sovrn
Source: https://www.coingecko.com/en/coins/ethereum/gbp?ref=wticker	HTTP Parser: Iframe src: https://contextual.media.net/checksync.php?vsSync=1&cs=8&cv=31&https=1&cid=8CU18831I&prvid=2034%2C2033%2C2011%2C3022%2C3020%2C2030%2C273%2C251%2C175%2C2009%2C255%2C178%2C3018%2C2028%2C3017%2C2027%2C236%2C214%2C237%2C2025%2C3014%2C117%2C70%2C97%2C99%2C77%2C38%2C3012%2C3011%2C3010%2C182%2C261%2C141%2C222%2C3007%2C201%2C4%2C301%2C246%2C225%2C203%2C80%2C10000%2C9%2C108&purpose1=1&gdprconsent=1&gdpr=0&usp_status=0&usp_consent=1&itype=PREBID
Source: https://www.coingecko.com/en/coins/ethereum/gbp?ref=wticker	HTTP Parser: Iframe src: https://eu-u.openx.net/w/1.0/pd?plm=6&ph=626fe778-b2ca-415b-a3f6-584fd2ac5ec0&gdpr=0
Source: https://www.coingecko.com/en/coins/ethereum/gbp?ref=wticker	HTTP Parser: Iframe src: https://ap.lijit.com/beacon?informer=8128488
Source: https://www.coingecko.com/en/coins/ethereum/gbp?ref=wticker	HTTP Parser: Iframe src: https://acdn.adnxs.com/dmp/async_usersync.html
Source: https://www.coingecko.com/en/coins/ethereum/gbp?ref=wticker	HTTP Parser: Iframe src: https://eus.rubiconproject.com/usync.html
Source: https://www.coingecko.com/en/coins/ethereum/gbp?ref=wticker	HTTP Parser: Iframe src: https://onetag-sys.com/usync/?cb=1633716936582
Source: https://www.coingecko.com/en/coins/ethereum/gbp?ref=wticker	HTTP Parser: Iframe src: https://eb2.3lift.com/sync?

# DE&&TECT

# A- logging 
any kind of logging as bignner is good and increase your exprinse what you want need from logging recoreds to secure more your environemnet day by day , 

automation schedulling looking for alerts in path of logging file example in linux system in path /var/log/*


# B- network intrstion detection system
dont foreget to check yoyr IDS WORKING AS DEAMON in backgound to detection and logging for any alert example suricata tool

# C- dont stop sniffing on your network rotational
sometimes the attackers is success connection to outside network to c2 server , should take snaping traffic with wireshark or tshark or tcpdump and archiving as pcap for intrusion analaysis in two mode THIS VERY HIGH NOTES AS FOLLOWING

( two traffic capture modes )
a- active with starting browsing on intenet and save pcap with ending your activity on outside your network
b- passive , is not making any activity on internet or outside network , capture traffic for 1000 packets example and sace pcap

after this comparing analysis between two modes , if you getting any activity dns or url or domain or external ip in second mode you already compromised and should block this traffic and defending to prevent in another round

# DEFEND

# A- auditing

1- linux and windowds hardening and audit 
in linux install auditd and download customise auditd rule 

2- disable recuressive dns query and disable cach for dns poising 
in linux /etc/bind/named.conf.options
and edit this change and save

allow-transfer {"none";};
allow-recursion {"none";};
recursion no;

my be using pi-hole is useful for disable rucreesive dns query

question now why you need to your query reach to dns root servers ? i think you dont need if the website you visit not have answer for his dns hosting by sourse code example ads network

edit /etc/resolv.conf

# B- firewall
should to be have any firewall with simple understanding configuration rules 
am recommended ufw is the best for my openion and great choise if you want large scale by insatlling it at service on respery-pi

the https://github.com/resteex0/dns-redirectors-report have update every time with evilip list , you can download with ufw firewall to preventation from this kinds of evil attacks

# C- network intrustion preventation system or network intrstion detection system

am recommended suricata is the best IDS in history for detection or preventation and his exellent job for this kind of attacks

note : suricata not working as you want if you dont customizing or download rules you needing for you understand , am recommended et open rules 

# D- baning for abusing bruteforce
fail2ban example good for ban ssh bruteforce 
if you optimum security do audit and ban together as ssh service

# F- dont trust for any plugin connect to internet 
special internet browsers pluggines as firefox or chrome or IE is hidden agent for bad traffic and redirect dns query to special dns server , should be clean your environement by what you install what you select to work

# H- host intrustion preventation system or host intrstion detection system for malware and trojan
yara rules is best and antimalware repestive for yara rule is clamav good choise , if combined clamav and wazuh you will getting highly secure environment after above all steps for defending

# sample very evil mitre matrix at starting point of story
https://app.any.run/tasks/4fd07de5-0327-45a9-8df4-ae7090492d0b#
https://any.run/report/f959f1cef3e7ebffd07cf37ba0f4295b275c29a30591282a269cde35c672a600/4fd07de5-0327-45a9-8df4-ae7090492d0b

command line sequence 
https://attack.mitre.org/techniques/T1012/
https://attack.mitre.org/techniques/T1518/

"C:\Program Files\Internet Explorer\iexplore.exe" "C:\Users\admin\AppData\Local\Temp\url.html" >>>>>>>> PID 1016 

"C:\Program Files\Internet Explorer\iexplore.exe" SCODEF:1016 CREDAT:144385 /prefetch:2 >>>>>> PID 3512  

"C:\Program Files\Internet Explorer\iexplore.exe" SCODEF:1016 CREDAT:333057 /prefetch:2 >>>>>> PID 4056 

"C:\Program Files\Internet Explorer\iexplore.exe" SCODEF:1016 CREDAT:595203 /prefetch:2 >>>>>> PID 2540
